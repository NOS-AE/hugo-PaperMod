{{- /* Comments area start */ -}}
{{- /* to add comments read => https://gohugo.io/content-management/comments/ */ -}}

<script>
    function getGiscusTheme() {
    const theme = localStorage.getItem("pref-theme");
    if (theme == null) {
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            theme = "dark";
        }
    }
    return theme === "dark" ? "transparent_dark" : "light";
    }

    // load giscus script
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.setAttribute("data-repo", "{{ .Site.Params.giscus.repo }}");
    script.setAttribute("data-repo-id", "{{ .Site.Params.giscus.repoId }}");
    script.setAttribute("data-category", "{{ .Site.Params.giscus.category }}");
    script.setAttribute("data-category-id", "{{ .Site.Params.giscus.categoryId }}");
    script.setAttribute("data-mapping", "{{ .Site.Params.giscus.mapping }}");
    script.setAttribute("data-strict", "{{ .Site.Params.giscus.strict }}");
    script.setAttribute("data-reactions-enabled", "{{ .Site.Params.giscus.reactionsEnabled }}");
    script.setAttribute("data-emit-metadata", "{{ .Site.Params.giscus.emitMetadata }}");
    script.setAttribute("data-input-position", "{{ .Site.Params.giscus.inputPosition }}");
    script.setAttribute("data-theme", getGiscusTheme());
    script.setAttribute("data-lang", "{{ .Site.Params.giscus.lang }}");
    script.setAttribute("crossorigin", "{{ .Site.Params.giscus.crossorigin }}");
    script.async = true;
    document.getElementById("post-single").appendChild(script);

    window.onload = () => {
        // observe theme toggle
        const toggleGiscusTheme = () => {
            const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow;
            giscus.postMessage({ giscus: {
                setConfig: {
                    theme: getGiscusTheme()
                }
            }}, 'https://giscus.app');
        }
        document.getElementById("theme-toggle").onclick = toggleGiscusTheme;
        document.getElementById("theme-toggle-footer").onclick = toggleGiscusTheme;
    }
</script>
{{- /* Comments area end */ -}}
